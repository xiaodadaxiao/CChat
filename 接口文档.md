## 说明

接口的说明

## 接口

### 注册登录接口

#### 发送验证码

- url：/register/code

- 请求方式：post

- 说明：传递邮箱地址，发送验证码到邮箱，有效期为十分钟

- 请求参数：

| 参数  | 说明         | 是否必填 |
| ----- | ------------ | -------- |
| email | 要注册的邮箱 | 是       |

- 返回参数：

| 参数    | 说明                                                           |
| ------- | -------------------------------------------------------------- |
| status  | 200：成功；201：用户已存在；202：验证码还没过期；400：参数错误 |
| endTime | 验证码结束时间                                                 |

#### 注册账号

- url：/register

- 请求方式：post

- 说明：传递邮箱、验证码、密码 。注册用户

- 请求参数：

| 参数     | 说明         | 是否必填 |
| -------- | ------------ | -------- |
| email    | 要注册的邮箱 | 是       |
| code     | 验证码       | 是       |
| password | 密码         | 是       |

- 返回参数：

| 参数   | 说明                                                                          |
| ------ | ----------------------------------------------------------------------------- |
| status | 200：成功；201：用户已存在；400：参数错误；401：验证码过期；402：验证码不正确 |
| cid    | 用户唯一 id                                                                   |
| name   | 初始默认为“用户+cid“                                                          |
| email  | 用户注册的邮箱                                                                |

#### 登录

- url：/login

- 请求方式：post

- 说明：传递 CID、密码 。登录，返回 token 凭证

  > 注：token 需要在后续请求中，在请求头 Authorization 中携带

- 请求参数：

| 参数     | 说明              | 是否必填 |
| -------- | ----------------- | -------- |
| cid      | 要登录的 cid 账号 | 是       |
| password | 密码              | 是       |

- 返回参数：

| 参数   | 说明                                                     |
| ------ | -------------------------------------------------------- |
| status | 200：成功；400：参数错误；401：用户不存在；402：密码错误 |
| token  | 登录凭证                                                 |

### 权限认证接口

#### 检查 token

- url：/auth/token

- 请求方式：post

- 说明：传递 token。检查 token 是否有效

- 请求参数：

| 参数                            | 说明           | 是否必填 |
| ------------------------------- | -------------- | -------- |
| 在请求头字段 Authorization 携带 | 要校验的 token | 是       |

- 返回参数：

| 参数    | 说明                                          |
| ------- | --------------------------------------------- |
| status  | 200：成功；201：有效，附带新 token；400：无效 |
| cid     | 返回 token 中用户 cid                         |
| endTime | （status=200）token 结束时间                  |
| token   | （status=201）新的 token                      |

### 好友接口

#### 获得好友列表

- url：/friend/list

- 请求方式：get

- 说明：传递 token。得到所有好友信息的列表

- 请求参数：

| 参数                            | 说明           | 是否必填 |
| ------------------------------- | -------------- | -------- |
| 在请求头字段 Authorization 携带 | 要校验的 token | 是       |

- 返回参数：

| 参数   | 说明                                               |
| ------ | -------------------------------------------------- |
| status | 200：成功；201：好友数量为 0；400：无效            |
| data   | 返回的用户信息（json），以索引为对象分布[根据昵称] |

```json
{
  "status": 200,
  "data": {
    "x": [
      {
        "friendCid": "10001",
        "nickname": "小明",
        "lastTime": "2021-10-16T09:25:20.000Z",
        "state": 0,
        "avatarUrl": null,
        "friendName": "用户10001"
      }
    ],
    "#": [
      {
        "friendCid": "10002",
        "nickname": "???好友",
        "lastTime": "2021-10-15T10:29:17.000Z",
        "state": 0,
        "avatarUrl": null,
        "friendName": "用户10002"
      }
    ]
  }
}
```



#### 添加好友请求

- url：/friend/apply/:cid

- 请求方式：post

- 说明：传递 token、params的要添加的cid、message。添加申请记录

- 请求参数：

| 参数                            | 说明           | 是否必填 |
| ------------------------------- | -------------- | -------- |
| 在请求头字段 Authorization 携带 | 要校验的 token | 是       |
| message                         | 申请的信息     | 否       |

- 返回参数：

| 参数   | 说明                 |
| ------ | -------------------- |
| status | 200：成功；400：失败 |



#### 同意好友请求

- url：/friend/agree/:cid

- 请求方式：post

- 说明：传递 token、params的要同意的用户cid

- 请求参数：

| 参数                            | 说明           | 是否必填 |
| ------------------------------- | -------------- | -------- |
| 在请求头字段 Authorization 携带 | 要校验的 token | 是       |
| cid                             | 申请添加的用户 | 是       |

- 返回参数：

| 参数   | 说明                 |
| ------ | -------------------- |
| status | 200：成功；400：失败 |



#### 拒绝好友请求

- url：/friend/reject/:cid

- 请求方式：post

- 说明：传递 token、params的要拒绝的用户cid

- 请求参数：

| 参数                            | 说明           | 是否必填 |
| ------------------------------- | -------------- | -------- |
| 在请求头字段 Authorization 携带 | 要校验的 token | 是       |
| cid                             | 申请添加的用户 | 是       |

- 返回参数：

| 参数   | 说明                 |
| ------ | -------------------- |
| status | 200：成功；400：失败 |



#### 获取好友申请列表

- url：/friend/apply

- 请求方式：get

- 说明：传递 token。获得正在申请的好友申请列表

- 请求参数：

| 参数                            | 说明           | 是否必填 |
| ------------------------------- | -------------- | -------- |
| 在请求头字段 Authorization 携带 | 要校验的 token | 是       |

- 返回参数：

| 参数   | 说明                 |
| ------ | -------------------- |
| status | 200：成功；400：失败 |
| data   | 数据                 |



### 用户接口

#### 搜索用户 cid

- url：/user/search/:cid

- 请求方式：get

- 说明：传递要搜索的 cid，返回信息

- 请求参数：

| 参数                            | 说明         | 是否必填 |
| ------------------------------- | ------------ | -------- |
| 在请求头字段 Authorization 携带 | token        | 是       |
| cid                             | 要搜索的 cid | 是       |

- 返回参数：

| 参数   | 说明                          |
| ------ | ----------------------------- |
| status | 200：用户存在；400 用户不存在 |
| cid    | 返回的用户 cid                |

#### 获取用户信息

- url：/user/info/:cid

- 请求方式：get

- 说明：请求头 tokn，以及要查询的 cid，返回信息

- 请求参数：

| 参数 | 说明         | 是否必填 |
| ---- | ------------ | -------- |
| cid  | 要搜索的 cid | 是       |

- 返回参数：

| 参数     | 说明                          |
| -------- | ----------------------------- |
| status   | 200：请求成功；400 用户不存在 |
| relation | 我和该用户的关系              |
| userInfo | 用户信息                      |

relation.type:OWN我本人，FRIEND好友，STRANGER陌生人， ME_ADDING我正在添加该用户，ADDING_ME该用户正在添加我

relation.info:对应type关系的信息：略

```js
{
    "status": 200,
    "relation": {
        "type": "ME_ADDING",
        "info": {
            "time": "2021-10-17T04:19:23.000Z",
            "message": "你好，我是小张"
        }
    },
    "userInfo": {
        "cid": "10002",
        "name": "用户10002",
        "avatarUrl": "https://file.qqtouxiang.com/1.jpeg",
        "signature": null
    }
}
```



